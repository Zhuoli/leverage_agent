<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';">
    <title>Atlassian AI Assistant</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>ü§ñ AI Assistant</h2>
            </div>

            <div class="sidebar-content">
                <div class="config-status" id="configStatus">
                    <div class="status-indicator" id="statusIndicator"></div>
                    <span id="statusText">Checking configuration...</span>
                </div>

                <div class="quick-actions">
                    <h3>Quick Actions</h3>
                    <button class="action-btn" onclick="quickAction('sprint')">
                        üìã My Sprint Tasks
                    </button>
                    <button class="action-btn" onclick="quickAction('today')">
                        üìÖ Today's Work
                    </button>
                    <button class="action-btn" onclick="quickAction('search')">
                        üîç Search Confluence
                    </button>
                    <button class="action-btn" onclick="quickAction('recent')">
                        üìÑ Recent Pages
                    </button>
                </div>

                <div class="settings-section">
                    <button class="settings-btn" onclick="openSettings()">
                        ‚öôÔ∏è Settings
                    </button>
                    <button class="settings-btn" onclick="clearChat()">
                        üóëÔ∏è Clear Chat
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Chat Area -->
        <div class="main-content">
            <div class="chat-header">
                <h1>Chat with Your Atlassian Assistant</h1>
                <p>Ask me about your Jira tasks or Confluence documentation</p>
            </div>

            <div class="chat-container" id="chatContainer">
                <div class="welcome-message">
                    <h2>üëã Welcome!</h2>
                    <p>I can help you with:</p>
                    <ul>
                        <li>üìã Viewing and analyzing your Jira tasks</li>
                        <li>üîç Searching Confluence pages</li>
                        <li>üìñ Reading and summarizing documentation</li>
                        <li>üí° Answering questions about your work</li>
                    </ul>
                    <p class="hint">Try asking: "What are my sprint tasks?" or "Search for API documentation"</p>
                </div>
            </div>

            <div class="input-container">
                <div class="input-wrapper">
                    <textarea
                        id="messageInput"
                        placeholder="Ask me anything about Jira or Confluence..."
                        rows="1"
                    ></textarea>
                    <button id="sendButton" onclick="sendMessage()">
                        <span class="send-icon">‚û§</span>
                    </button>
                </div>
                <div class="input-hint">
                    Press Enter to send, Shift+Enter for new line
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚öôÔ∏è Settings</h2>
                <button class="close-btn" onclick="closeSettings()">√ó</button>
            </div>
            <div class="modal-body">
                <!-- Model Provider Selection -->
                <div class="form-group">
                    <label>AI Provider</label>
                    <select id="modelProvider" onchange="onProviderChange()">
                        <option value="claude">Claude (Anthropic)</option>
                        <option value="openai">OpenAI (ChatGPT)</option>
                    </select>
                </div>

                <!-- Model Name -->
                <div class="form-group">
                    <label>Model Name (Optional)</label>
                    <input type="text" id="modelName" placeholder="Leave empty for default">
                    <small class="hint">Examples: claude-3-5-sonnet-20241022, gpt-4</small>
                </div>

                <!-- Conditional API Keys -->
                <div class="form-group" id="anthropicKeyGroup">
                    <label>Anthropic API Key</label>
                    <input type="password" id="anthropicKey" placeholder="sk-ant-...">
                </div>

                <div class="form-group" id="openaiKeyGroup" style="display: none;">
                    <label>OpenAI API Key</label>
                    <input type="password" id="openaiKey" placeholder="sk-...">
                </div>

                <div class="form-group">
                    <label>Jira URL</label>
                    <input type="text" id="jiraUrl" placeholder="https://jira.yourcompany.com">
                </div>
                <div class="form-group">
                    <label>Jira Username</label>
                    <input type="text" id="jiraUsername" placeholder="your.email@company.com">
                </div>
                <div class="form-group">
                    <label>Jira API Token</label>
                    <input type="password" id="jiraToken">
                </div>
                <div class="form-group">
                    <label>Confluence URL</label>
                    <input type="text" id="confluenceUrl" placeholder="https://confluence.yourcompany.com">
                </div>
                <div class="form-group">
                    <label>Confluence Username</label>
                    <input type="text" id="confluenceUsername" placeholder="your.email@company.com">
                </div>
                <div class="form-group">
                    <label>Confluence API Token</label>
                    <input type="password" id="confluenceToken">
                </div>
                <div class="form-group">
                    <label>Confluence Space Key (optional)</label>
                    <input type="text" id="confluenceSpace" placeholder="TEAM">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeSettings()">Cancel</button>
                <button class="btn-primary" onclick="saveSettings()">Save Settings</button>
            </div>
        </div>
    </div>

    <script src="renderer.js"></script>
</body>
</html>
